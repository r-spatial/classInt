<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Head/Tails breaks • classInt</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Head/Tails breaks">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">classInt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4-11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/headtailsR.html">Head/Tails breaks</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatial/classInt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Head/Tails breaks</h1>
                        <h4 data-toc-skip class="author">Diego
Hernangomez</h4>
            
            <h4 data-toc-skip class="date">2024-11-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatial/classInt/blob/HEAD/vignettes/headtailsR.Rmd" class="external-link"><code>vignettes/headtailsR.Rmd</code></a></small>
      <div class="d-none name"><code>headtailsR.Rmd</code></div>
    </div>

    
    
<blockquote>
<em>There are far more ordinary people (say, 80 percent) than
extraordinary people (say, 20 percent); this is often characterized by
the 80/20 principle, based on the observation made by the Italian
economist Vilfredo Pareto in 1906 that 80% of land in Italy was owned by
20% of the population. A histogram of the data values for these
phenomena would reveal a right-skewed or heavy-tailed distribution. How
to map the data with the heavy-tailed distribution?</em>
<div style="text-align: right">
<span class="citation">Jiang (2013)</span>
</div>
</blockquote>
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>This vignette discusses the implementation of the “Head/tail breaks”
style (<span class="citation">Jiang (2013)</span>) in the
<code>classIntervals</code> function. A step-by-step example is
presented in order to clarify the method. A case study using
<code><a href="https://jakubnowosad.com/spData/reference/afcon.html" class="external-link">spData::afcon</a></code> is also included, as well as a test suite
checking the performance and validation of the implementation.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <strong>Head/tail breaks</strong>, sometimes referred as
<strong>ht-index</strong> (<span class="citation">Jiang and Yin
(2013)</span>), is a classification scheme introduced by <span class="citation">Jiang (2013)</span> in order to find groupings or
hierarchy for data with a heavy-tailed distribution.</p>
<p>Heavy-tailed distributions are heavily right skewed, with a minority
of large values in the head and a majority of small values in the tail.
This imbalance between the head and tail, or between many small values
and a few large values, can be expressed as <em>“far more small things
than large things”</em>.</p>
<p>Heavy tailed distributions are commonly characterized by a power law,
a lognormal or an exponential function. Nature, society, finance (<span class="citation">Vasicek (2002)</span>) and our daily lives are full of
rare and extreme events, which are termed “black swan events” (<span class="citation">Taleb (2008)</span>). This line of thinking provides a
good reason to reverse our thinking by focusing on low-frequency
events.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/classInt/">classInt</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#1. Characterization of heavy-tail distributions----</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="co">#Pareto distribution a=1 b=1.161 n=1000</span></span>
<span><span class="va">sample_par</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">^</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">1.161</span><span class="op">)</span></span>
<span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">sample_par</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"F(x)"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"80/20 principle"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">sample_par</span>, <span class="fl">.8</span><span class="op">)</span> ,</span>
<span>       lty <span class="op">=</span> <span class="fl">2</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"red3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0.2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sample_par</span><span class="op">)</span> ,</span>
<span>       lty <span class="op">=</span> <span class="fl">2</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"topleft"</span>,</span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F(x): p80"</span>, <span class="st">"x: Top 20%"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red3"</span>, <span class="st">"darkblue"</span><span class="op">)</span>,</span>
<span>  lty <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span></span>
<span>  <span class="va">sample_par</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Histogram"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  border <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>  probability <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></code></pre></div>
<p><img src="headtailsR_files/figure-html/charheavytail-1.png" width="700"><img src="headtailsR_files/figure-html/charheavytail-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="breaking-method">Breaking method<a class="anchor" aria-label="anchor" href="#breaking-method"></a>
</h2>
<p>The method itself consists on a four-step process performed
recursively until a stopping condition is satisfied. Given a vector of
values <code>var</code> the process can be described as follows:</p>
<ol style="list-style-type: decimal">
<li>Compute <code>mu = mean(var)</code>.</li>
<li>Break <code>var</code> into the <code>tail</code> (as
<code>var &lt; mu</code>) and the <code>head</code> (as
<code>var &gt; mu</code>).</li>
<li>Assess if the proportion of <code>head</code> over <code>var</code>
is lower or equal than a given threshold
(i.e. <code>length(head)/length(var) &lt;= thr</code>)</li>
<li>If 3 is <code>TRUE</code>, repeat 1 to 3 until the condition is
<code>FALSE</code> or no more partitions are possible
(i.e. <code>head</code> has less than two elements expressed as
<code>length(head) &lt; 2</code>).</li>
</ol>
<p>It is important to note that, at the beginning of a new iteration,
<code>var</code> is replaced by <code>head</code>. The underlying
hypothesis is to create partitions until the head and the tail are
balanced in terms of distribution.So the stopping criteria is satisfied
when the last head and the last tail are evenly balanced.</p>
<p>In terms of threshold, <span class="citation">Jiang, Liu, and Jia
(2013)</span> set 40% as a good approximation, meaning that if the head
contains more than 40% of the observations the distribution is not
considered heavy-tailed.</p>
<p>The final breaks are the vector of consecutive <code>mu</code>.</p>
</div>
<div class="section level2">
<h2 id="step-by-step-example">Step by step example<a class="anchor" aria-label="anchor" href="#step-by-step-example"></a>
</h2>
<p>We reproduce here the pseudo-code<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The method implemented in &lt;code&gt;classInt&lt;/code&gt;
corresponds to head/tails 1.0 as named in this article.&lt;/p&gt;"><sup>1</sup></a> as per <span class="citation">Jiang
(2019)</span>:</p>
<pre><code>Recursive function Head/tail Breaks:
 Rank the input data from the largest to the smallest
 Break the data into the head and the tail around the mean;
 // the head for those above the mean
 // the tail for those below the mean
 While (head &lt;= 40%):
 Head/tail Breaks (head);
End Function</code></pre>
<p>A step-by-step example in <strong>R</strong> (for illustrative
purposes) has been developed:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">var</span> <span class="op">&lt;-</span> <span class="va">sample_par</span></span>
<span><span class="va">thr</span> <span class="op">&lt;-</span> <span class="fl">.4</span></span>
<span><span class="va">brks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">var</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">var</span><span class="op">)</span><span class="op">)</span>  <span class="co">#Initialise with min and max</span></span>
<span></span>
<span><span class="va">sum_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  iter <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  mu <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  prop <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  n_var <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  n_head <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#Pars for chart</span></span>
<span><span class="va">limchart</span> <span class="op">&lt;-</span> <span class="va">brks</span></span>
<span><span class="co">#Iteration</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">var</span><span class="op">)</span></span>
<span>  <span class="va">brks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">brks</span>, <span class="va">mu</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">head</span> <span class="op">&lt;-</span> <span class="va">var</span><span class="op">[</span><span class="va">var</span> <span class="op">&gt;</span> <span class="va">mu</span><span class="op">]</span></span>
<span>  <span class="va">prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">head</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">var</span><span class="op">)</span></span>
<span>  <span class="va">stopit</span> <span class="op">&lt;-</span> <span class="va">prop</span> <span class="op">&lt;</span> <span class="va">thr</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">head</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span></span>
<span>  <span class="va">sum_table</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">sum_table</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">mu</span>, <span class="va">prop</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">var</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">head</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span></span>
<span>    <span class="va">var</span>,</span>
<span>    main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Iter "</span>, <span class="va">i</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fl">50</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>    xlim <span class="op">=</span> <span class="va">limchart</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">mu</span>, col <span class="op">=</span> <span class="st">"red3"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">ylabel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">var</span>, breaks <span class="op">=</span> <span class="fl">50</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">counts</span><span class="op">)</span></span>
<span>  <span class="va">labelplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"PropHead: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">prop</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mu</span>,</span>
<span>    y <span class="op">=</span> <span class="va">ylabel</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">labelplot</span>,</span>
<span>    cex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>    pos <span class="op">=</span> <span class="fl">4</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>    <span class="st">"right"</span>,</span>
<span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="va">i</span><span class="op">)</span>,</span>
<span>    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red3"</span><span class="op">)</span>,</span>
<span>    lty <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    cex <span class="op">=</span> <span class="fl">0.8</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isFALSE</a></span><span class="op">(</span><span class="va">stopit</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">break</span></span>
<span>  <span class="va">var</span> <span class="op">&lt;-</span> <span class="va">head</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></code></pre></div>
<p><img src="headtailsR_files/figure-html/stepbystep-1.png" width="700"><img src="headtailsR_files/figure-html/stepbystep-2.png" width="700"><img src="headtailsR_files/figure-html/stepbystep-3.png" width="700"><img src="headtailsR_files/figure-html/stepbystep-4.png" width="700"></p>
<p>As it can be seen, in each iteration the resulting head gradually
loses the high-tail property, until the stopping condition is met.</p>
<table class="table">
<thead><tr class="header">
<th align="right">iter</th>
<th align="right">mu</th>
<th align="left">prop</th>
<th align="right">n_var</th>
<th align="right">n_head</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">5.6755</td>
<td align="left">14.5%</td>
<td align="right">1000</td>
<td align="right">145</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">27.2369</td>
<td align="left">21.38%</td>
<td align="right">145</td>
<td align="right">31</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">85.1766</td>
<td align="left">19.35%</td>
<td align="right">31</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">264.7126</td>
<td align="left">50%</td>
<td align="right">6</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>The resulting breaks are then defined as
<code>breaks = c(min(var), mu(iter=1), ..., mu(iter), max(var))</code>.</p>
</div>
<div class="section level2">
<h2 id="implementation-in-classint-package">Implementation in <code>classInt</code> package<a class="anchor" aria-label="anchor" href="#implementation-in-classint-package"></a>
</h2>
<p>The implementation in the <code>classIntervals</code> function should
replicate the results:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ht_sample_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">sample_par</span>, style <span class="op">=</span> <span class="st">"headtails"</span><span class="op">)</span></span>
<span><span class="va">brks</span> <span class="op">==</span> <span class="va">ht_sample_par</span><span class="op">$</span><span class="va">brks</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE TRUE TRUE TRUE TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ht_sample_par</span><span class="op">)</span></span>
<span><span class="co">#&gt; style: headtails</span></span>
<span><span class="co">#&gt; [1.000295,5.675463) [5.675463,27.23693) [27.23693,85.17664) [85.17664,264.7126) </span></span>
<span><span class="co">#&gt;                 855                 114                  25                   3 </span></span>
<span><span class="co">#&gt; [264.7126,523.6254] </span></span>
<span><span class="co">#&gt;                   3</span></span></code></pre></div>
<p>As stated in <span class="citation">Jiang (2013)</span>, the number
of breaks is naturally determined, however the <code>thr</code>
parameter could help to adjust the final number. A lower value on
<code>thr</code> would provide less breaks while a larger
<code>thr</code> would increase the number, if the underlying
distribution follows the <em>“far more small things than large
things”</em> principle.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pal1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wheat1"</span>, <span class="st">"wheat2"</span>, <span class="st">"red3"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Minimum: single break</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">sample_par</span>, style <span class="op">=</span> <span class="st">"headtails"</span>, thr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; style: headtails</span></span>
<span><span class="co">#&gt; [1.000295,5.675463) [5.675463,523.6254] </span></span>
<span><span class="co">#&gt;                 855                 145</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">sample_par</span>, style <span class="op">=</span> <span class="st">"headtails"</span>, thr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  pal <span class="op">=</span> <span class="va">pal1</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"thr = 0"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Two breaks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">sample_par</span>, style <span class="op">=</span> <span class="st">"headtails"</span>, thr <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; style: headtails</span></span>
<span><span class="co">#&gt; [1.000295,5.675463) [5.675463,27.23693) [27.23693,523.6254] </span></span>
<span><span class="co">#&gt;                 855                 114                  31</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">sample_par</span>, style <span class="op">=</span> <span class="st">"headtails"</span>, thr <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  pal <span class="op">=</span> <span class="va">pal1</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"thr = 0.2"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default breaks: 0.4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">sample_par</span>, style <span class="op">=</span> <span class="st">"headtails"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; style: headtails</span></span>
<span><span class="co">#&gt; [1.000295,5.675463) [5.675463,27.23693) [27.23693,85.17664) [85.17664,264.7126) </span></span>
<span><span class="co">#&gt;                 855                 114                  25                   3 </span></span>
<span><span class="co">#&gt; [264.7126,523.6254] </span></span>
<span><span class="co">#&gt;                   3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">sample_par</span>, style <span class="op">=</span> <span class="st">"headtails"</span><span class="op">)</span>,</span>
<span>     pal <span class="op">=</span> <span class="va">pal1</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"thr = Default"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Maximum breaks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">sample_par</span>, style <span class="op">=</span> <span class="st">"headtails"</span>, thr <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; style: headtails</span></span>
<span><span class="co">#&gt; [1.000295,5.675463) [5.675463,27.23693) [27.23693,85.17664) [85.17664,264.7126) </span></span>
<span><span class="co">#&gt;                 855                 114                  25                   3 </span></span>
<span><span class="co">#&gt;  [264.7126,391.279)  [391.279,523.6254] </span></span>
<span><span class="co">#&gt;                   2                   1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">sample_par</span>, style <span class="op">=</span> <span class="st">"headtails"</span>, thr <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  pal <span class="op">=</span> <span class="va">pal1</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"thr = 1"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></code></pre></div>
<p><img src="headtailsR_files/figure-html/examplesimp-1.png" width="700"><img src="headtailsR_files/figure-html/examplesimp-2.png" width="700"><img src="headtailsR_files/figure-html/examplesimp-3.png" width="700"><img src="headtailsR_files/figure-html/examplesimp-4.png" width="700"></p>
<p>The method always returns at least one break, corresponding to
<code>mean(var)</code>.</p>
</div>
<div class="section level2">
<h2 id="case-study">Case study<a class="anchor" aria-label="anchor" href="#case-study"></a>
</h2>
<p><span class="citation">Jiang (2013)</span> states that “the new
classification scheme is more natural than the natural breaks in finding
the groupings or hierarchy for data with a heavy-tailed distribution.”
(p. 482), referring to Jenks’ natural breaks method. In this case study
we would compare “headtails” vs. “fisher”, that is the alias for the
Fisher-Jenks algorithm and it is always preferred to the “jenks” style
(see <code><a href="../reference/classIntervals.html">?classIntervals</a></code>). For this example we will use the
<code>afcon</code> dataset from <code>spData</code> package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jakubnowosad.com/spData/" class="external-link">spData</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">afcon</span>, package <span class="op">=</span> <span class="st">"spData"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s have a look to the Top 10 values and the distribution of the
variable <code>totcon</code> (index of total conflict 1966-78):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Top10</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"name"</span>,<span class="st">"totcon"</span><span class="op">)</span><span class="op">]</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">name</th>
<th align="right">totcon</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">EG</td>
<td align="left">EGYPT</td>
<td align="right">5246</td>
</tr>
<tr class="even">
<td align="left">SU</td>
<td align="left">SUDAN</td>
<td align="right">4751</td>
</tr>
<tr class="odd">
<td align="left">UG</td>
<td align="left">UGANDA</td>
<td align="right">3134</td>
</tr>
<tr class="even">
<td align="left">CG</td>
<td align="left">ZAIRE</td>
<td align="right">3087</td>
</tr>
<tr class="odd">
<td align="left">TZ</td>
<td align="left">TANZANIA</td>
<td align="right">2881</td>
</tr>
<tr class="even">
<td align="left">LY</td>
<td align="left">LIBYA</td>
<td align="right">2355</td>
</tr>
<tr class="odd">
<td align="left">KE</td>
<td align="left">KENYA</td>
<td align="right">2273</td>
</tr>
<tr class="even">
<td align="left">SO</td>
<td align="left">SOMALIA</td>
<td align="right">2122</td>
</tr>
<tr class="odd">
<td align="left">ET</td>
<td align="left">ETHIOPIA</td>
<td align="right">1878</td>
</tr>
<tr class="even">
<td align="left">SF</td>
<td align="left">SOUTH AFRICA</td>
<td align="right">1875</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span>,</span>
<span>     n <span class="op">=</span> <span class="fl">20</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Histogram"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"totcon"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>     border <span class="op">=</span> <span class="cn">NA</span>, <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Distribution"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"totcon"</span>,</span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></code></pre></div>
<p><img src="headtailsR_files/figure-html/summspdata-1.png" width="700"><img src="headtailsR_files/figure-html/summspdata-2.png" width="700"></p>
<p>The data shows that EG and SU data present a clear hierarchy over the
rest of values. As per the histogram, we can confirm a heavy-tailed
distribution and therefore the <em>“far more small things than large
things”</em> principle.</p>
<p>As a testing proof, on top of “headtails” and “fisher” we would use
also “quantile” to have a broader view on the different breaking styles.
As “quantile” is a position-based metric, it doesn’t account for the
magnitude of F(x) (hierarchy), so the breaks are solely defined by the
position of x on the distribution.</p>
<p>Applying the three aforementioned methods to break the data:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brks_ht</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span>, style <span class="op">=</span> <span class="st">"headtails"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">brks_ht</span><span class="op">)</span></span>
<span><span class="co">#&gt; style: headtails</span></span>
<span><span class="co">#&gt;   one of 91,390 possible partitions of this variable into 5 classes</span></span>
<span><span class="co">#&gt;    [147,1350.619) [1350.619,2488.6)   [2488.6,3819.8)   [3819.8,4998.5) </span></span>
<span><span class="co">#&gt;                27                10                 3                 1 </span></span>
<span><span class="co">#&gt;     [4998.5,5246] </span></span>
<span><span class="co">#&gt;                 1</span></span>
<span><span class="co">#Same number of classes for "fisher"</span></span>
<span><span class="va">nclass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">brks_ht</span><span class="op">$</span><span class="va">brks</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">brks_fisher</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span>, style <span class="op">=</span> <span class="st">"fisher"</span>,</span>
<span>                               n <span class="op">=</span> <span class="va">nclass</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">brks_fisher</span><span class="op">)</span></span>
<span><span class="co">#&gt; style: fisher</span></span>
<span><span class="co">#&gt;   one of 91,390 possible partitions of this variable into 5 classes</span></span>
<span><span class="co">#&gt;    [147,693.5) [693.5,1474.5)  [1474.5,2618)  [2618,3942.5)  [3942.5,5246] </span></span>
<span><span class="co">#&gt;             12             17              8              3              2</span></span>
<span></span>
<span><span class="va">brks_quantile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span>, style <span class="op">=</span> <span class="st">"quantile"</span>,</span>
<span>                                n <span class="op">=</span> <span class="va">nclass</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">brks_quantile</span><span class="op">)</span></span>
<span><span class="co">#&gt; style: quantile</span></span>
<span><span class="co">#&gt;   one of 91,390 possible partitions of this variable into 5 classes</span></span>
<span><span class="co">#&gt;       [147,604)     [604,833.6)  [833.6,1137.2) [1137.2,1877.4)   [1877.4,5246] </span></span>
<span><span class="co">#&gt;               8               9               8               8               9</span></span>
<span></span>
<span><span class="va">pal1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wheat1"</span>, <span class="st">"wheat2"</span>, <span class="st">"red3"</span><span class="op">)</span></span>
<span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">brks_ht</span>, pal <span class="op">=</span> <span class="va">pal1</span>, main <span class="op">=</span> <span class="st">"headtails"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">brks_fisher</span>, pal <span class="op">=</span> <span class="va">pal1</span>, main <span class="op">=</span> <span class="st">"fisher"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">brks_quantile</span>, pal <span class="op">=</span> <span class="va">pal1</span>, main <span class="op">=</span> <span class="st">"quantile"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></code></pre></div>
<p><img src="headtailsR_files/figure-html/breaksample-1.png" width="700"><img src="headtailsR_files/figure-html/breaksample-2.png" width="700"><img src="headtailsR_files/figure-html/breaksample-3.png" width="700"></p>
<p>It is observed that the top three classes of “headtails” enclose 5
observations, whereas “fisher” includes 13 observations. In terms of
classification, “headtails” breaks focuses more on extreme values.</p>
<p>The next plot compares a continuous distribution of
<code>totcon</code> re-escalated to a range of <code>[1,nclass]</code>
versus the distribution across breaks for each style. The continuous
distribution has been offset by -0.5 in order to align the continuous
and the discrete distributions.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Helper function to rescale values</span></span>
<span><span class="va">help_reescale</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">min</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">max</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op">*</span> <span class="op">(</span><span class="va">max</span> <span class="op">-</span> <span class="va">min</span><span class="op">)</span> <span class="op">+</span> <span class="va">min</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">afcon</span><span class="op">$</span><span class="va">ecdf_class</span> <span class="op">&lt;-</span> <span class="fu">help_reescale</span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span>,</span>
<span>                                  min <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.5</span>,</span>
<span>                                  max <span class="op">=</span> <span class="va">nclass</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">afcon</span><span class="op">$</span><span class="va">ht_breaks</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span>,</span>
<span>                        <span class="va">brks_ht</span><span class="op">$</span><span class="va">brks</span>,</span>
<span>                        labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                        include.lowest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">afcon</span><span class="op">$</span><span class="va">fisher_breaks</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span>,</span>
<span>                            <span class="va">brks_fisher</span><span class="op">$</span><span class="va">brks</span>,</span>
<span>                            labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                            include.lowest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">afcon</span><span class="op">$</span><span class="va">quantile_break</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span>,</span>
<span>                             <span class="va">brks_quantile</span><span class="op">$</span><span class="va">brks</span>,</span>
<span>                             labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             include.lowest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">ecdf_class</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  main <span class="op">=</span> <span class="st">""</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"class"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">ht_breaks</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"darkblue"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">fisher_breaks</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"limegreen"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">quantile_break</span><span class="op">)</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"red3"</span>,</span>
<span>      lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Continuous"</span>, <span class="st">"headtails"</span>,</span>
<span>                  <span class="st">"fisher"</span>, <span class="st">"quantile"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"darkblue"</span>, <span class="st">"limegreen"</span>, <span class="st">"red3"</span><span class="op">)</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></code></pre></div>
<p><img src="headtailsR_files/figure-html/benchmarkbreaks-1.png" width="672"></p>
<p>It can be observed that the distribution of “headtails” breaks is
also heavy-tailed, and closer to the original distribution. On the other
extreme, “quantile” provides a quasi-uniform distribution, ignoring the
<code>totcon</code> hierarchy</p>
<p>In terms of data visualization, we compare here the final map using
the techniques mentioned above. On this plotting exercise:</p>
<ul>
<li>
<code>cex</code> of points are always between <code>1</code> and
<code>5</code>.</li>
<li>For the continuous approach, no classes are provided. This plot will
be used as the reference.</li>
<li>For all the rest of styles, <code>col</code> and <code>cex</code> on
each point is defined as per the class of that point.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">custompal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FE9F6D99"</span>,</span>
<span>               <span class="st">"#DE496899"</span>,</span>
<span>               <span class="st">"#8C298199"</span>,</span>
<span>               <span class="st">"#3B0F7099"</span>,</span>
<span>               <span class="st">"#00000499"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">afcon</span><span class="op">$</span><span class="va">cex_points</span> <span class="op">&lt;-</span> <span class="fu">help_reescale</span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span>,</span>
<span>                                  min <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                  max <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="co"># Plot continuous</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">afcon</span><span class="op">$</span><span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="va">afcon</span><span class="op">$</span><span class="va">y</span>,</span>
<span>  axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex <span class="op">=</span> <span class="va">afcon</span><span class="op">$</span><span class="va">cex_points</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Continuous"</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mcont</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">4</span></span>
<span><span class="va">legcont</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">*</span> <span class="va">mcont</span> <span class="op">-</span> <span class="op">(</span><span class="va">mcont</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">afcon</span><span class="op">$</span><span class="va">totcon</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>,</span>
<span>       xjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"   "</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">legcont</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>                  <span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  pt.cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"totcon"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">afcon</span><span class="op">$</span><span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="va">afcon</span><span class="op">$</span><span class="va">y</span>,</span>
<span>  axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex <span class="op">=</span> <span class="va">afcon</span><span class="op">$</span><span class="va">ht_breaks</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  col <span class="op">=</span> <span class="va">custompal</span><span class="op">[</span><span class="va">afcon</span><span class="op">$</span><span class="va">ht_breaks</span><span class="op">]</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"headtails"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"bottomleft"</span>,</span>
<span>  xjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"   "</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">brks_ht</span><span class="op">$</span><span class="va">brks</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>,<span class="fl">0</span><span class="op">)</span></span>
<span>                  <span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="va">custompal</span>,</span>
<span>  pt.cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"totcon"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">afcon</span><span class="op">$</span><span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="va">afcon</span><span class="op">$</span><span class="va">y</span>,</span>
<span>  axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex <span class="op">=</span> <span class="va">afcon</span><span class="op">$</span><span class="va">fisher_breaks</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  col <span class="op">=</span> <span class="va">custompal</span><span class="op">[</span><span class="va">afcon</span><span class="op">$</span><span class="va">fisher_breaks</span><span class="op">]</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"fisher"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"bottomleft"</span>,</span>
<span>  xjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"   "</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">brks_fisher</span><span class="op">$</span><span class="va">brks</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>,<span class="fl">0</span><span class="op">)</span></span>
<span>                  <span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="va">custompal</span>,</span>
<span>  pt.cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"totcon"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">afcon</span><span class="op">$</span><span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="va">afcon</span><span class="op">$</span><span class="va">y</span>,</span>
<span>  axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex <span class="op">=</span> <span class="va">afcon</span><span class="op">$</span><span class="va">quantile_break</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  col <span class="op">=</span> <span class="va">custompal</span><span class="op">[</span><span class="va">afcon</span><span class="op">$</span><span class="va">quantile_break</span><span class="op">]</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"quantile"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"bottomleft"</span>,</span>
<span>  xjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"   "</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">brks_quantile</span><span class="op">$</span><span class="va">brks</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>,<span class="fl">0</span><span class="op">)</span></span>
<span>                  <span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="va">custompal</span>,</span>
<span>  pt.cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"totcon"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></code></pre></div>
<p><img src="headtailsR_files/figure-html/finalplot%20-1.png" width="700"><img src="headtailsR_files/figure-html/finalplot%20-2.png" width="700"><img src="headtailsR_files/figure-html/finalplot%20-3.png" width="700"><img src="headtailsR_files/figure-html/finalplot%20-4.png" width="700"></p>
<p>As per the results, “headtails” seems to provide a better
understanding of the most extreme values when the result is compared
against the continuous plot. The “quantile” style, as expected, just
provides a clustering without taking into account the real hierarchy.
The “fisher” plot is in-between of these two interpretations.</p>
<p>It is also important to note that “headtails” and “fisher” reveal
different information that can be useful depending of the context. While
“headtails” highlights the outliers, it fails on providing a good
clustering on the tail, while “fisher” seems to reflect better these
patterns. This can be observed on the values of Western Africa and the
Niger River Basin, where “headtails” doesn’t highlight any special
cluster of conflicts, “fisher” suggests a potential cluster. This can be
confirmed on the histogram generated previously, where a concentration
of <code>totcon</code> around 1,000 is visible.</p>
</div>
<div class="section level2">
<h2 id="testing-and-benchmark">Testing and benchmark<a class="anchor" aria-label="anchor" href="#testing-and-benchmark"></a>
</h2>
<p>On this section the performance of the “headtails” implementation is
tested, in terms of speed and handling of corner cases. A small
benchmark with another styles is also presented.</p>
<p>Testing has been performed over the following distributions:</p>
<p><strong>Heavy-tailed distributions</strong></p>
<ul>
<li>Pareto</li>
<li>Exponential</li>
<li>Log-normal</li>
<li>Weibull</li>
<li>Log-Cauchy, also known as super-heavy tail distribution (<span class="citation">Falk, Huesler, and Reiss (2011)</span>, p. 80, <span class="citation">Fraga Alves, Haan, and Neves (2009)</span>)</li>
</ul>
<p><strong>Non heavy-tailed distributions</strong></p>
<ul>
<li>Normal (non heavy-tailed)</li>
<li>Truncated Normal (left-tailed)</li>
<li>Uniform distribution</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Init samples</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2389</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Pareto distributions a=7 b=14</span></span>
<span><span class="va">paretodist</span> <span class="op">&lt;-</span> <span class="fl">7</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">5000000</span><span class="op">)</span><span class="op">)</span> <span class="op">^</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">14</span><span class="op">)</span></span>
<span><span class="co">#Exponential dist</span></span>
<span><span class="va">expdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">5000000</span><span class="op">)</span></span>
<span><span class="co">#Lognorm</span></span>
<span><span class="va">lognormdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">5000000</span><span class="op">)</span></span>
<span><span class="co">#Weibull</span></span>
<span><span class="va">weibulldist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">rweibull</a></span><span class="op">(</span><span class="fl">5000000</span>, <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#LogCauchy "super-heavy tail"</span></span>
<span><span class="va">logcauchdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Cauchy.html" class="external-link">rcauchy</a></span><span class="op">(</span><span class="fl">5000000</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Remove Inf </span></span>
<span><span class="va">logcauchdist</span> <span class="op">&lt;-</span> <span class="va">logcauchdist</span><span class="op">[</span><span class="va">logcauchdist</span> <span class="op">&lt;</span> <span class="cn">Inf</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#Normal dist</span></span>
<span><span class="va">normdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5000000</span><span class="op">)</span></span>
<span><span class="co">#Left-tailed distr</span></span>
<span><span class="va">leftnorm</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">normdist</span><span class="op">[</span><span class="va">normdist</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">normdist</span><span class="op">)</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5000000</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Uniform distribution</span></span>
<span><span class="va">unifdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">5000000</span><span class="op">)</span></span></code></pre></div>
<p>Let’s define a helper function and proceed to run the whole test
suite:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Title <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  style <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  nsample  <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  thresold <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  nbreaks <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  time_secs <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">benchmarkdist</span> <span class="op">&lt;-</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">dist</span>,</span>
<span>           <span class="va">style</span> <span class="op">=</span> <span class="st">"headtails"</span>,</span>
<span>           <span class="va">thr</span> <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>           <span class="va">title</span> <span class="op">=</span> <span class="st">""</span>,</span>
<span>           <span class="va">plot</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">br</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">dist</span>, style <span class="op">=</span> <span class="va">style</span>, thr <span class="op">=</span> <span class="va">thr</span><span class="op">)</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">init</span></span>
<span>    <span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      Title <span class="op">=</span> <span class="va">title</span>,</span>
<span>      style  <span class="op">=</span> <span class="va">style</span>,</span>
<span>      nsample  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">br</span><span class="op">$</span><span class="va">var</span><span class="op">)</span>, </span>
<span>                        scientific <span class="op">=</span> <span class="cn">FALSE</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>      thresold <span class="op">=</span> <span class="va">thr</span>,</span>
<span>      nbreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">br</span><span class="op">$</span><span class="va">brks</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>      time_secs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">a</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">testresults</span>, <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">plot</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">br</span><span class="op">$</span><span class="va">var</span>,</span>
<span>                from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">dist</span>,<span class="fl">.0005</span><span class="op">)</span>,</span>
<span>                to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">dist</span>,<span class="fl">.9995</span><span class="op">)</span></span>
<span>                <span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>        cex.main <span class="op">=</span> <span class="fl">.9</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>          <span class="va">title</span>,</span>
<span>          <span class="st">" "</span>,</span>
<span>          <span class="va">style</span>,</span>
<span>          <span class="st">", thr ="</span>,</span>
<span>          <span class="va">thr</span>,</span>
<span>          <span class="st">", nbreaks = "</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">br</span><span class="op">$</span><span class="va">brks</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>        <span class="op">)</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">""</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">br</span><span class="op">$</span><span class="va">brks</span>,</span>
<span>             col <span class="op">=</span> <span class="st">"red3"</span>,</span>
<span>             lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">testresults</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pareto----</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">paretodist</span>, title <span class="op">=</span> <span class="st">"Pareto"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">paretodist</span>, title <span class="op">=</span> <span class="st">"Pareto"</span>, thr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">paretodist</span>, title <span class="op">=</span> <span class="st">"Pareto"</span>, thr <span class="op">=</span> <span class="fl">.75</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Sample 2,000 obs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">Paretosamp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">paretodist</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">Paretosamp</span>,</span>
<span>                             title <span class="op">=</span> <span class="st">"Pareto sample"</span>,</span>
<span>                             style <span class="op">=</span> <span class="st">"fisher"</span>,</span>
<span>                             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">Paretosamp</span>,</span>
<span>                             title <span class="op">=</span> <span class="st">"Pareto sample"</span>,</span>
<span>                             style <span class="op">=</span> <span class="st">"headtails"</span>,</span>
<span>                             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#Exponential----</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">expdist</span>, title <span class="op">=</span> <span class="st">"Exponential"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">expdist</span>, title <span class="op">=</span> <span class="st">"Exponential"</span>, thr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">expdist</span>, title <span class="op">=</span> <span class="st">"Exponential"</span>, thr <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">expdist</span>, title <span class="op">=</span> <span class="st">"Exponential"</span>,</span>
<span>                             style <span class="op">=</span> <span class="st">"quantile"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Weibull-----</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">weibulldist</span>, title <span class="op">=</span> <span class="st">"Weibull"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">weibulldist</span>, title <span class="op">=</span> <span class="st">"Weibull"</span>, thr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">weibulldist</span>, title <span class="op">=</span> <span class="st">"Weibull"</span>, thr <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Logcauchy</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">logcauchdist</span>, title <span class="op">=</span> <span class="st">"LogCauchy"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">logcauchdist</span>, title <span class="op">=</span> <span class="st">"LogCauchy"</span>, thr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">logcauchdist</span>, title <span class="op">=</span> <span class="st">"LogCauchy"</span>, thr <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Normal----</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">normdist</span>, title <span class="op">=</span> <span class="st">"Normal"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">normdist</span>, title <span class="op">=</span> <span class="st">"Normal"</span>, thr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">normdist</span>, title <span class="op">=</span> <span class="st">"Normal"</span>, thr <span class="op">=</span> <span class="fl">1</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Truncated Left-tail Normal----</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">leftnorm</span>, title <span class="op">=</span> <span class="st">"Left Normal"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">leftnorm</span>, title <span class="op">=</span> <span class="st">"Left Normal"</span>, thr <span class="op">=</span> <span class="op">-</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">leftnorm</span>, title <span class="op">=</span> <span class="st">"Left Normal"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, thr <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Uniform----</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">unifdist</span>, title <span class="op">=</span> <span class="st">"Uniform"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, thr <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">unifdist</span>, title <span class="op">=</span> <span class="st">"Uniform"</span>, thr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">testresults</span> <span class="op">&lt;-</span> <span class="fu">benchmarkdist</span><span class="op">(</span><span class="va">unifdist</span>, title <span class="op">=</span> <span class="st">"Uniform"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, thr <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Results</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">testresults</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Title</th>
<th align="left">style</th>
<th align="left">nsample</th>
<th align="right">thresold</th>
<th align="right">nbreaks</th>
<th align="left">time_secs</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Pareto</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">0.40</td>
<td align="right">15</td>
<td align="left">0.6011</td>
</tr>
<tr class="even">
<td align="left">Pareto</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">0.00</td>
<td align="right">2</td>
<td align="left">0.5309</td>
</tr>
<tr class="odd">
<td align="left">Pareto</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">0.75</td>
<td align="right">15</td>
<td align="left">0.6358</td>
</tr>
<tr class="even">
<td align="left">Pareto sample</td>
<td align="left">fisher</td>
<td align="left">2,000</td>
<td align="right">0.40</td>
<td align="right">12</td>
<td align="left">0.0182</td>
</tr>
<tr class="odd">
<td align="left">Pareto sample</td>
<td align="left">headtails</td>
<td align="left">2,000</td>
<td align="right">0.40</td>
<td align="right">8</td>
<td align="left">3e-04</td>
</tr>
<tr class="even">
<td align="left">Exponential</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">0.40</td>
<td align="right">16</td>
<td align="left">0.4342</td>
</tr>
<tr class="odd">
<td align="left">Exponential</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">0.00</td>
<td align="right">2</td>
<td align="left">0.5263</td>
</tr>
<tr class="even">
<td align="left">Exponential</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">1.00</td>
<td align="right">17</td>
<td align="left">0.6421</td>
</tr>
<tr class="odd">
<td align="left">Exponential</td>
<td align="left">quantile</td>
<td align="left">5,000,000</td>
<td align="right">0.40</td>
<td align="right">24</td>
<td align="left">0.7996</td>
</tr>
<tr class="even">
<td align="left">Weibull</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">0.40</td>
<td align="right">16</td>
<td align="left">0.4925</td>
</tr>
<tr class="odd">
<td align="left">Weibull</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">0.00</td>
<td align="right">2</td>
<td align="left">0.4268</td>
</tr>
<tr class="even">
<td align="left">Weibull</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">1.00</td>
<td align="right">17</td>
<td align="left">0.4812</td>
</tr>
<tr class="odd">
<td align="left">LogCauchy</td>
<td align="left">headtails</td>
<td align="left">4,991,187</td>
<td align="right">0.40</td>
<td align="right">6</td>
<td align="left">0.5268</td>
</tr>
<tr class="even">
<td align="left">LogCauchy</td>
<td align="left">headtails</td>
<td align="left">4,991,187</td>
<td align="right">0.00</td>
<td align="right">2</td>
<td align="left">0.4404</td>
</tr>
<tr class="odd">
<td align="left">LogCauchy</td>
<td align="left">headtails</td>
<td align="left">4,991,187</td>
<td align="right">1.00</td>
<td align="right">6</td>
<td align="left">0.471</td>
</tr>
<tr class="even">
<td align="left">Normal</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">0.40</td>
<td align="right">2</td>
<td align="left">0.5293</td>
</tr>
<tr class="odd">
<td align="left">Normal</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">0.00</td>
<td align="right">2</td>
<td align="left">0.4351</td>
</tr>
<tr class="even">
<td align="left">Normal</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">1.00</td>
<td align="right">17</td>
<td align="left">0.5372</td>
</tr>
<tr class="odd">
<td align="left">Left Normal</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">0.40</td>
<td align="right">2</td>
<td align="left">0.6412</td>
</tr>
<tr class="even">
<td align="left">Left Normal</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">-100.00</td>
<td align="right">2</td>
<td align="left">0.5529</td>
</tr>
<tr class="odd">
<td align="left">Left Normal</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">500.00</td>
<td align="right">21</td>
<td align="left">0.7722</td>
</tr>
<tr class="even">
<td align="left">Uniform</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">0.70</td>
<td align="right">22</td>
<td align="left">0.5698</td>
</tr>
<tr class="odd">
<td align="left">Uniform</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">0.00</td>
<td align="right">2</td>
<td align="left">0.4208</td>
</tr>
<tr class="even">
<td align="left">Uniform</td>
<td align="left">headtails</td>
<td align="left">5,000,000</td>
<td align="right">1.00</td>
<td align="right">22</td>
<td align="left">0.5682</td>
</tr>
</tbody>
</table>
<p><img src="headtailsR_files/figure-html/testresults-1.png" width="700"><img src="headtailsR_files/figure-html/testresults-2.png" width="700"><img src="headtailsR_files/figure-html/testresults-3.png" width="700"><img src="headtailsR_files/figure-html/testresults-4.png" width="700"><img src="headtailsR_files/figure-html/testresults-5.png" width="700"><img src="headtailsR_files/figure-html/testresults-6.png" width="700"><img src="headtailsR_files/figure-html/testresults-7.png" width="700"><img src="headtailsR_files/figure-html/testresults-8.png" width="700"><img src="headtailsR_files/figure-html/testresults-9.png" width="700"><img src="headtailsR_files/figure-html/testresults-10.png" width="700"><img src="headtailsR_files/figure-html/testresults-11.png" width="700"><img src="headtailsR_files/figure-html/testresults-12.png" width="700"><img src="headtailsR_files/figure-html/testresults-13.png" width="700"><img src="headtailsR_files/figure-html/testresults-14.png" width="700"></p>
<p>The implementation works as expected, with a good performance given
the size of the sample, and also compares well with another current
implementations in <code>classIntervals</code>.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Falk_2011" class="csl-entry">
Falk, Michael, Juerg Huesler, and Rolf-Dieter Reiss. 2011. <em>Laws of
Small Numbers: Extremes and Rare Events</em>. <em>Laws of Small Numbers:
Extremes and Rare Events</em>. <a href="https://doi.org/10.1007/978-3-0348-0009-9" class="external-link">https://doi.org/10.1007/978-3-0348-0009-9</a>.
</div>
<div id="ref-Fraga_2009" class="csl-entry">
Fraga Alves, Maria, L. D. Haan, and Claudia Neves. 2009.
<span>“Statistical Inference for Heavy and Super-Heavy Tailed
Distributions.”</span> <em>J. Stat. Plan. Inf.</em> 139 (January):
213–27.
</div>
<div id="ref-Jiang_2013" class="csl-entry">
Jiang, Bin. 2013. <span>“Head/Tail Breaks: A New Classification Scheme
for Data with a Heavy-Tailed Distribution.”</span> <em>The Professional
Geographer</em> 65 (3): 482–94. <a href="https://doi.org/10.1080/00330124.2012.700499" class="external-link">https://doi.org/10.1080/00330124.2012.700499</a>.
</div>
<div id="ref-Jiang_2019" class="csl-entry">
———. 2019. <span>“A Recursive Definition of Goodness of Space for
Bridging the Concepts of Space and Place for Sustainability.”</span>
<em>Sustainability</em> 11 (15): 4091. <a href="https://doi.org/10.3390/su11154091" class="external-link">https://doi.org/10.3390/su11154091</a>.
</div>
<div id="ref-Jiang3_2013" class="csl-entry">
Jiang, Bin, Xintao Liu, and Tao Jia. 2013. <span>“Scaling of Geographic
Space as a Universal Rule for Map Generalization.”</span> <em>Annals of
the Association of American Geographers</em> 103 (4): 844–55. <a href="https://doi.org/10.1080/00045608.2013.765773" class="external-link">https://doi.org/10.1080/00045608.2013.765773</a>.
</div>
<div id="ref-Jiang2_2013" class="csl-entry">
Jiang, Bin, and Junjun Yin. 2013. <span>“Ht-Index for Quantifying the
Fractal or Scaling Structure of Geographic Features.”</span> <em>Annals
of the Association of American Geographers</em> 104 (3): 530–40. <a href="https://doi.org/10.1080/00045608.2013.834239" class="external-link">https://doi.org/10.1080/00045608.2013.834239</a>.
</div>
<div id="ref-taleb_black_2008" class="csl-entry">
Taleb, Nassim Nicholas. 2008. <em>The Black Swan: The Impact of the
Highly Improbable</em>. 1st ed. London: Random House.
</div>
<div id="ref-vasicek2012" class="csl-entry">
Vasicek, Oldrich. 2002. <span>“Loan Portfolio Value.”</span>
<em>Risk</em>, December, 160–62.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
